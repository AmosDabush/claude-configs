# Critical Questions - שאלות קריטיות

> שאלות שבאמת חייבים תשובה עליהן כי הן יכולות לגרום לבאגים או להתנהגות לא צפויה.
> Questions that actually need answers because they can cause bugs or unexpected behavior.

---

## 1. קונפליקט מקורות נתוני הנשמה / Respirator Data Source Conflict

**הבעיה:**
- הדשבורד מושך נתוני הנשמה מ-nursing_status עם Type 1
- האגרגטור מושך נתוני הנשמה מטבלת condition עם קודים מפרמטר RespirationCodesCham
- מטופל יכול להיראות מונשם במסך אחד ולא במסך אחר

**השאלה:**
- האם זה באג או מכוון?
- אם מכוון - מה ההבדל העסקי בין שני המקורות?
- אם באג - איזה מקור צריך להיות המקור האמיתי?

---

## 2. מה זה nursing_status_type = 4? / What is nursing_status_type = 4?

**הבעיה:**
- Type 1, 2, 3 מתועדים ומשומשים בקוד
- Type 4 קיים בדאטה אבל אין שום שימוש בו בקוד

**השאלה:**
- מה Type 4 אמור לייצג?
- זה legacy שצריך למחוק? פיצ'ר עתידי? משהו שנשכח?

---

## 3. רשימת ערכי result_status מלאה / Complete result_status Values

**הבעיה:**
- בקוד יש רק X ו-F
- כנראה יש עוד ערכים (P=Preliminary? C=Corrected?)
- בלי הרשימה המלאה אי אפשר לדעת איך להציג תוצאות מעבדה למשתמש

**השאלה:**
- מה כל הערכים האפשריים של result_status?
- מה המשמעות של כל אחד?

---

## 4. תאריכי בידוד כפולים / Dual Isolation Dates

**הבעיה:**
- יש isolation_start_date ו-coview_start_date
- יש isolation_end_date ו-coview_end_date
- הקוד משתמש ב-GREATEST של כולם כדי לקבוע "מה האחרון"

**השאלה:**
- מה ההבדל העסקי בין התאריכים?
- למה יש שני זוגות תאריכים?
- האם יש מקרים שבהם הם צריכים להיות שונים?

---

## 5. ערכי isolation_type ו-isolation_reason המלאים / Complete Isolation Types and Reasons

**הבעיה:**
- יש קודים מספריים (1, 3, 108, 119...) אבל אין רשימה מלאה
- כנראה יש עוד סוגים וסיבות בפרודקשן

**השאלה:**
- מה הרשימה המלאה של isolation_type_id וה-isolation_reason_id?
- מה כל קוד מייצג?

---

## 6. חישוב איחור בייעוצים / Consultation Delay Calculation

**הבעיה:**
- יש שדה is_delayed בייעוצים
- לא ברור איך מחשבים אם ייעוץ באיחור

**השאלה:**
- מה הכלל לקביעה שייעוץ באיחור?
- כמה זמן צריך לעבור מה-request_date?
- האם זה תלוי ב-urgency?

---

## 7. מה קורה כשייעוץ "דחוף" לא מטופל? / Urgent Consultation Not Handled

**הבעיה:**
- יש urgency = "דחוף"
- לא ברור מה קורה אם לא מטפלים בו

**השאלה:**
- האם יש אסקלציה אוטומטית?
- האם יש התראה למישהו?
- מה הציפייה מבחינת SLA לייעוץ דחוף?

---

## 8. מצב מטופל בניתוח vs ממתין לניתוח / Surgery States

**הבעיה:**
- יש patients_in_surgery ו-surgery_waiting
- לא ברור מה מעביר מטופל בין המצבים

**השאלה:**
- מי/מה מעביר מטופל מ"ממתין" ל"בניתוח"?
- זה אוטומטי מכמיליון? ידני? webhook?

---

## 9. האם אפשר למחוק בידוד? / Can Isolation Be Deleted?

**הבעיה:**
- לא ברור אם יש דרך "לבטל" בידוד
- או שרק אפשר לסיים אותו עם end_date

**השאלה:**
- איך מבטלים בידוד שהוזן בטעות?
- האם יש soft delete או hard delete?

---

## 10. מה קורה כשחדר נמחק עם מטופלים בפנים? / Room Deleted With Patients

**הבעיה:**
- אין FK constraint בין locations לבין cases
- תיאורטית אפשר למחוק חדר עם מטופלים

**השאלה:**
- מה צריך לקרות במקרה כזה?
- האם יש validation שמונע את זה?

---

## 11. פורמט הודעות Redis / Redis Message Format

**הבעיה:**
- כל שירות שולח הודעות ב-Redis
- אין סכמה מתועדת להודעות

**השאלה:**
- מה הפורמט המדויק של כל הודעה לכל topic?
- האם יש versioning להודעות?

---

## 12. מה קורה אם הסנכרון מכמיליון נכשל? / Chameleon Sync Failure

**הבעיה:**
- הסנכרון הוא event-driven
- לא ברור מה קורה אם הוא נכשל

**השאלה:**
- האם יש retry אוטומטי?
- האם יש התראה?
- איך יודעים שהסנכרון תקוע?

---

## 13. האם יש היסטוריה של שינויים? / Change History

**הבעיה:**
- הרבה טבלאות משתמשות ב-copy table pattern שמוחק את הנתונים הישנים
- לא ברור אם יש audit trail

**השאלה:**
- אילו טבלאות שומרות היסטוריה?
- איפה אפשר לראות מה השתנה ומתי?

---

## 14. מטופל לוויין - מי רואה אותו? / Satellite Patient Visibility

**הבעיה:**
- מטופל יכול להיות פיזית במחלקה אחת אבל רפואית במחלקה אחרת
- לא ברור מי צריך לראות אותו

**השאלה:**
- האם שתי המחלקות רואות את המטופל?
- האם יש הרשאות שונות לכל מחלקה?

---

## 15. מה קורה כשמטופל מועבר בין מחלקות? / Patient Transfer Between Wards

**הבעיה:**
- ההעברה מגיעה מכמיליון
- לא ברור מה קורה לנתונים ב-CoView

**השאלה:**
- האם הנתונים הישנים (אירועים, הערות) עוברים איתו?
- האם המחלקה הישנה עדיין רואה את ההיסטוריה?

---

## סיכום / Summary

| # | נושא / Topic | קריטיות / Criticality |
|---|--------------|----------------------|
| 1 | קונפליקט מקורות הנשמה | גבוהה - באג פוטנציאלי |
| 2 | nursing_status_type = 4 | בינונית - קוד מת? |
| 3 | result_status values | גבוהה - תצוגה שגויה |
| 4 | תאריכי בידוד כפולים | בינונית - בלבול |
| 5 | isolation types/reasons | בינונית - תצוגה |
| 6 | חישוב איחור ייעוצים | בינונית - לוגיקה |
| 7 | ייעוץ דחוף SLA | בינונית - אופרציה |
| 8 | מצבי ניתוח | בינונית - לוגיקה |
| 9 | מחיקת בידוד | בינונית - לוגיקה |
| 10 | מחיקת חדר עם מטופלים | נמוכה - edge case |
| 11 | פורמט Redis | בינונית - אינטגרציה |
| 12 | כשל סנכרון | גבוהה - אופרציה |
| 13 | היסטוריית שינויים | בינונית - audit |
| 14 | נראות מטופל לוויין | גבוהה - הרשאות |
| 15 | העברה בין מחלקות | בינונית - לוגיקה |

---

*Last Updated: 2025-12-21*
